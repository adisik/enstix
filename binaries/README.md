# enstix binaries

These are for [X-A4U-stick].

Some data (a hash of AES key and a hash of the password) is stored in
xmega's EEPROM - and this needs to be generated by you (you probably
don't want to use a key and a password set by me!).

You'll need [python](https://www.python.org/) 2.7
(with the [pycrypto](https://www.dlitz.net/software/pycrypto/) package
installed).  {Haven't tried python 3 yet.} All instructions are to be
executed in a terminal window.

## Installation / flashing

1. Generate `enstix.eep` file (with your hashed password and encrypted
   AES key):

          ./generate-eep.py

   Note that the script accepts `-h` parameter which lists the basic
   usage.

2. Put your stick into bootloader mode: hold the `E0` button during
   power-up or reset of the stick. It should enumerate as `DFU
   ATXMEGA128A4U`. Note that you might need ATMEL's DFU driver on
   Windows (it comes with ATMEL's [FLIP] utility).

3. Flash the firmware. On linux/Mac OS X, you can (and should) use
   [dfu-programmer] to do this; on Windows you can use [FLIP].

          dfu-programmer atxmega128a4u erase
          dfu-programmer atxmega128a4u flash --eeprom enstix.eep
          dfu-programmer atxmega128a4u flash enstix-x128a4u-{VERSION}.hex
          dfu-programmer atxmega128a4u reset

   Note that you'll need to flash the eeprom file every time (even if
   you just want to update firmware), because the DFU bootloader erases
   both flash _and_ eeprom. Also, you need to do it in this order (first
   eeprom, then flash).

That's it, enjoy!

[AVRstick]: http://matrixstorm.com/avr/avrstick/
[LUFA]: http://www.fourwalledcubicle.com/LUFA.php
[AVR-crypto-lib]: https://git.cryptolib.org/avr-crypto-lib.git
[Arduino Leonardo]: http://arduino.cc/en/Main/arduinoBoardLeonardo
[Teensy]: https://www.pjrc.com/store/teensy.html
[X-A4U-stick]: http://174763.calepin.co/x-a4u-stick-2.html
[FLIP]: http://www.atmel.com/tools/flip.aspx
[dfu-programmer]: https://dfu-programmer.github.io/
